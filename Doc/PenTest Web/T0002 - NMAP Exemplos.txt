NMAP
====

- Busca por lista -sL
---------------------

	root@kali-wellx64:~# nmap -sL webdoc.brisa.org.br/24

	Starting Nmap 7.40 ( https://nmap.org ) at 2017-07-05 18:04 -03
	Nmap scan report for 189.86.123.0
	Nmap scan report for 189.86.123.1
	Nmap scan report for 189.86.123.2
	Nmap scan report for centauro.brisa.org.br (189.86.123.3)
	Nmap scan report for nm04.brisa.org.br (189.86.123.4)
	Nmap scan report for marte.brisa.org.br (189.86.123.5)
	Nmap scan report for tritao.brisa.org.br (189.86.123.6)
	Nmap scan report for 189.86.123.7
	Nmap scan report for vy.brisa.org.br (189.86.123.8)
	Nmap scan report for 189.86.123.9
	Nmap scan report for 189.86.123.10
	Nmap scan report for 189.86.123.11
	Nmap scan report for 189.86.123.12
	Nmap scan report for 189.86.123.13
	Nmap scan report for ixion.brisa.org.br (189.86.123.14)
	Nmap scan report for capella.brisa.org.br (189.86.123.15)
	Nmap scan report for webdoc.brisa.org.br (189.86.123.16)
	rDNS record for 189.86.123.16: pandora.brisa.org.br
	Nmap scan report for 189.86.123.17
	Nmap scan report for lua.brisa.org.br (189.86.123.18)
	Nmap scan report for 189.86.123.19
	Nmap scan report for 189.86.123.20
	Nmap scan report for 189.86.123.21
	Nmap scan report for 189.86.123.22
	Nmap scan report for lyra.brisa.org.br (189.86.123.23)
	Nmap scan report for sedna.brisa.org.br (189.86.123.24)
	Nmap scan report for bspura15.brisa.org.br (189.86.123.25)
	Nmap scan report for 189.86.123.26
	Nmap scan report for 189.86.123.27
	--==[Rsumido]==--
	Nmap scan report for 189.86.123.99
	Nmap scan report for mercurio.brisa.org.br (189.86.123.100)
	Nmap scan report for 189.86.123.101
	--==[Rsumido]==--
	Nmap scan report for 189.86.123.226
	Nmap scan report for sedna.brisa.org.br (189.86.123.227)
	Nmap scan report for venus.brisa.org.br (189.86.123.228)
	Nmap scan report for proteus.brisa.org.br (189.86.123.229)
	Nmap scan report for caelum.brisa.org.br (189.86.123.230)
	Nmap scan report for 189.86.123.231
	--==[Rsumido]==--
	Nmap scan report for 189.86.123.255
	Nmap done: 256 IP addresses (0 hosts up) scanned in 14.11 seconds
	root@kali-wellx64:~#

Ping Sweep
----------

	# nmap -sP 10.10.10.*
	# nmap -sP 10.10.10.1/24
	# nmap -sP 10.10.10.1-254
	
ICMP Bloqueado
--------------
	# nmap -sL 10.10.10.*

Port Scan
---------

	# nmap -sS 10.10.10.15
	# nmap -sS -p 21,23,25,80,443,8080,1433,1521,3306 10.10.10.15

Intrusion Prevention or Active Filter
-------------------------------------

	# nmap -sS -T5 -p 21,23,25,80,443,8080,1433,1521,3306 10.10.10.15

Envio de um pacote a cada 15 segundos
-------------------------------------

	# nmap --scan-delay 15s -p 21,23,25,80,443,8080,1433,1521,3306 10.10.10.15

Envio de um pacote a cada 10 segundos
-------------------------------------

	# nmap --max-rate 0.1 -p 21,23,25,80,443,8080,1433,1521,3306 10.10.10.15

Envio de pacotes fragmentados em 8 bytes por vez
------------------------------------------------

	# nmap -f -p 21,23,25,80,443,8080,1433,1521,3306 10.10.10.15

Envio de pacotes fragmentados em 16 bytes por vez
-------------------------------------------------

	# nmap --mtu 16 -p 21,23,25,80,443,8080,1433,1521,3306 10.10.10.15

Tricker Para buscar de forma rápida muitos hosts em uma rede local
------------------------------------------------------------------

Não é preciso scanear todos os IP para identificar as subredes aivas, vamos escanear apenas endereços IP e portas conhecidas para identificar endereços ativos nas subredes, endereços IP final: x.x.x.1, x.x.x.10, x.x.x.100, x.x.x.101, x.x.x.192, x.x.x.150, x.x.x.200, x.x.x.250, x.x.x.201, x.x.x.253 e x.x.x.254 as portas: 21, 22, 23, 25, 53, 80, 443, 445 8080, 3128, e 3389

Vamos utilizar para mapear o nmap mas tunado, ele é extremamente rápido, porém barulhento.

	# nmap -A -T4 -n -top-ports 1000 --max-rtt-timeout=500ms --initial-rtt-timeout=200ms --min-rtt-timeout=200ms --open --stats-every 5ss x.x.x.0/24


Levantando sistemas com administração remota habilitado
-------------------------------------------------------

	# nmap -sV -sS -p22,3389 10.10.10.0/24

Levantando os Métodos HTTP(NSE)
-------------------------------

	# nmap --script http-methods 192.168.0.102 -p 80
	testando um caminho específico
	# nmap --script http-methods --script-args http-methods.url-path="/webdav" 192.168.0.102 -p 80
	Testando dos os métodos
	# nmap --script http-methods --script-args http-methods.test-all 192.168.0.102 -p 80
	Trocando o User-Agent
	# nmap --script http-methods --script-args http.useragent="NMAP FIREFOX"  192.168.0.102 -p 80

Levantando os Serviços com todos os scripts seguros (NSE)
---------------------------------------------------------

	# nmap --script safe 192.168.0.102

Utilizando todos os scripts que inicie com vnc (NSE)
----------------------------------------------------

	# nmap --script "vnc*" 192.168.0.106 -p 5900
	Modo Debug
	# nmap --script "vnc*" -d 192.168.0.106 -p 5900
	Passando as credenciais
	# nmap --script vnc-title --script-args creds.vnc=:1223456 192.168.0.106 -p 5900
	Usando todos os scripts exceto vnc-title
	# nmap --script "vnc* and not vnc-title" -d 192.168.0.106 -p 5900
	Executa os scripts para FTP e VNC que não seja da categoria intrusivo
	# nmaps --script "(ftp* or vnc*) and not instrusive" -d 192.168.0.106 -p 5900
	Todos os scripts FTP e todos os VNC não intrusivo
	# nmap --script "ftp* or (vnc* and not intrusive)" -d 192.168.0.106 -p 5900

Scripts utilizados para levantar questões de autenticação (NSE)
---------------------------------------------------------------

